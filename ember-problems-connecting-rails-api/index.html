<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Ryan LaBouve</title>
    <link rel="stylesheet" href="/css/app.css">
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,400italic,700,700italic|Droid+Sans:400,700|Droid+Sans+Mono' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/zenburn.min.css">
    <script src="//cdn.jsdelivr.net/highlight.js/8.8.0/highlight.min.js"></script>
    <script src="/bower_components/zepto/zepto.min.js"></script>
  </head>
  <body>
  <form class='search-form'>
    <div class="search-bar hide">
      <div class="container">
        <input placeholder="SEARCH..."/>
      </div>
    </div>
  </form>

  <div class="mobile-menu hide md-hide close-menu">
  <div class="clearfix px2 bar brand-menu">
    <div class="left">
      Menu
    </div>
    <div class="right bold">
      <span class="">x</span>
    </div>
  </div>
  <div class="bar brand-github clearfix">
    <a href="/" class="btn">
      Blog
    </a>
  </div>
  <div class="bar brand-github clearfix">
    <a href="/speaking" class="btn">
      Speaking
    </a>
  </div>
  <div class="bar brand-github clearfix">
    <a href="/projects" class="btn">
      Projects
    </a>
  </div>
  <div class="bar brand-github clearfix">
    <a href="/about" class="btn">
      About
    </a>
  </div>
  <div class="brand-rss bar clearfix">
    <a href="http://twitter.com/ryanlabouve" class="btn btn-icon">
      <span class="typcn typcn-rss"></span> RSS
    </a>
  </div>
  <div class="brand-twitter bar clearfix">
    <a href="http://twitter.com/ryanlabouve" class="btn btn-icon">
      <span class="typcn typcn-social-twitter"></span> Twitter
    </a>
  </div>
  <div class="brand-linkedin bar clearfix">
    <a href="https://www.linkedin.com/in/ryanlabouve" class="btn btn-icon">
      <span class="typcn typcn-social-linkedin"></span> LinkedIn
    </a>
  </div>
  <div class="brand-github bar clearfix">
    <a href="http://github.com/ryanlabouve/" class="btn btn-icon">
      <span class="typcn typcn-social-github"></span> Github
    </a>
  </div>
  <div class="brand-dribbble bar clearfix">
    <a href="http://dribbble.com/ryanlabouve/" class="btn btn-icon">
      <span class="typcn typcn-social-dribbble"></span> Dribbble
    </a>
  </div>
</div>

  <div class="header">
    <div class="clearfix container">
      <a href="/" class="header__title h3 bold caps left px2">
        <img src="/assets/ha-circle.png" height=25 width=25 style="vertical-align: text-bottom;" alt="HolyArchers.com" /> Ryan LaBouve
      </a>

      <a href="/" class="btn left serif italic md-show">
        Blog
      </a>
      <a href="/speaking" class="btn left serif italic md-show">
        Speaking
      </a>
      <a href="/projects" class="btn left serif italic md-show">
        Projects
      </a>
      <a href="/about" class="btn left serif italic md-show">
        About
      </a>

      <div class="right md-hide">
        <a href="#" class="btn btn-icon btn-dark left open-menu">
          <span class="typcn typcn-th-menu-outline"></span> Menu
        </a>
      </div>
      <div class="right md-show">
        <a href="http://twitter.com/ryanlabouve" class="btn btn-icon left">
          <span class="typcn typcn-social-twitter"></span>
        </a>
        <a href="https://www.linkedin.com/in/ryanlabouve" class="btn btn-icon left">
          <span class="typcn typcn-social-linkedin"></span>
        </a>
        <a href="http://github.com/ryanlabouve/" class="btn btn-icon left">
          <span class="typcn typcn-social-github"></span>
        </a>
        <a href="http://dribbble.com/ryanlabouve/" class="btn btn-icon left">
          <span class="typcn typcn-social-dribbble"></span>
        </a>
        <a href="" class="btn btn-icon btn-dark btn-search left">
          <span class="typcn typcn-zoom"></span>
        </a>
      </div>
    </div>
  </div>


  
  <div class="container">
    <div class="box lg-px4">
      <div class="py4 px2 sm-px4">
        <div class="post lg-px4">
          <div class="right primary">January 29, 2015</div>
          <h1 class="serif">Ember Problems, Connecting to Rails-API</h1>
          <blockquote>
<p>Problem 1: you want to connect Ember-CLI to an actual API</p>
</blockquote>
<p>Welcome to part 1 of my 10 part series <strong>Ember Problems</strong>. I wrote down 10 <em>real problems</em> I had when learning ember, and we’ll solve them one by one. We’ll be using exploring them from both Ember-CLI and Rails throughout this series. Today we are going to solve <em>Connecting Ember to a Rails API.</em></p>
<p><style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style><div class='embed-container'><iframe src='https://www.youtube.com/embed/r4H9rnhUyv4' frameborder='0' allowfullscreen></iframe></div></p>
<p>Here’s all the code for today’s lesson: <a href="https://github.com/ryanlabouve/todomvc-api/tree/ep1">github.com/ryanlabouve/todomvc-api</a></p>
<h2 id="started-with-todomvc-with-ember-cli">Started with TodoMVC with Ember-CLI</h2>
<p>On a <a href="http://ryanlabouve.com/todomvc-ember-cli/">previous tutorial</a> we build TodoMVC with Ember-CLI. We left off by switching from the fixture adapter (<code>DS.FixtureAdapter</code>) to the local storage adapter (<code>DS.LSAdapter</code>).</p>
<p>For our tutorial today we are building the most basic Rails API for TodoMVC. Then we are switching our Ember app to use our API via the Active Model Adapter (<code>DS.ActiveModelAdapter</code>).</p>
<h2 id="building-the-api">Building the API</h2>
<p>We’re going to use the <a href="https://github.com/rails-api/rails-api">rails-api gem</a> for the API, because of the gem’s scaffolding generator and Ember compatibility via the <a href="https://github.com/rails-api/active_model_serializers">rails-api/active_model_serializers</a>.</p>
<p>First, make sure you have the rails-api gem installed.</p>
<pre><code>gem install rails-api
</code></pre><p>Then create a new rails-api project called <a href="https://github.com/ryanlabouve/todomvc-api">todomvc-api</a>.</p>
<pre><code>rails-api new todomvc-api
cd todomvc-api
</code></pre><h3 id="our-specification">Our Specification</h3>
<p>Based on the fixtures from TodoMVC, our models have two basic properties that we’ll need.</p>
<ol>
<li><em>[title]</em>, String: the title of the todo</li>
<li><em>[isCompleted]</em>, String: wheter the todo has been done yet</li>
</ol>
<p><strong>WARNING: Ember is camel-cased (e.g. isCompleted) and Rails is underscored (e.g. is_completed). So inside of Rails, use underscores. We’ll see later how the adapter helps both sides resolve this difference.</strong></p>
<p>So now we’ll actually create the todo resource using the rails-api scaffold.</p>
<pre><code>rails g scaffold todo title:string is_completed:boolean
bundle exec rake db:migrate
</code></pre><p>Now if we boot up our rails server, and look at our new <code>todo</code> route,</p>
<pre><code>rails s
open http://localhost:3000/todos
</code></pre><p>we’ll see an empty json array.</p>
<p><img src="../posts/2015-01-29-ember-to-rails-api/ep1-after-scaffold.png" alt="Ember Problems 1: Data After Scaffold"></p>
<h3 id="adding-fake-data">Adding Fake Data</h3>
<p>Before we move on, let’s quickly generate some fake data to populate our api using the <a href="https://github.com/stympy/faker">faker gem</a>.</p>
<h4 id="adding-faker-to-gemfile">Adding Faker to Gemfile</h4>
<pre><code># Gemfile
# ...
gem &#39;faker&#39;
# ...
</code></pre><h4 id="making-seeds">Making Seeds</h4>
<p>For our fake data we are going to use a little Lorem Ipsum from Faker and then a random <code>true</code> or <code>false</code> for the <code>is_completed</code>.</p>
<pre><code># db/seeds.rb
20.times do
  Todo.create(
    title: Faker::Lorem.words.join(&#39; &#39;),
    is_completed: [true, false].sample
  )
end
</code></pre><p>Now we can use rake to run the seeds.</p>
<pre><code>bundle exec rake db:seed
</code></pre><p>Now we can refresh <code>http://localhost:3000/todos</code> to verify that our seeds works.</p>
<p><img src="../posts/2015-01-29-ember-to-rails-api/ep1-data-preview.png" alt="Preview of Seed Data"></p>
<h3 id="switching-to-active-model-serializer">Switching to Active Model Serializer</h3>
<p><a href="https://github.com/rails-api/active_model_serializers">Active Model Serializer</a> is is what we’ll use to craft the JSON that our API returns. We need to do this because Ember expects a certain format for the JSON to be in, and also because we’ll want to strip off un-needed properties from the JSON.</p>
<h4 id="add-active_model_serializer-to-gemfile">Add active_model_serializer to gemfile</h4>
<pre><code># Gemfile
# ...
gem &#39;faker&#39;
gem &#39;active_model_serializers&#39;, &#39;~&gt; 0.8.1&#39;
# ...
</code></pre><p>_Please note, if you do <code>gem &#39;active_model_serializers&#39;</code> without a version number after it, you are entering a world of pain._</p>
<h4 id="generate-serializer">Generate serializer</h4>
<p>The serializer file, which we are generating, is the file that affects the JSON.</p>
<pre><code>rails g serializer Todo id title is_completed
</code></pre><p>Let’s look at the file we just created, <code>serializers/todo_serializer.rb</code>. Anything that’s listed in <code>attributes</code> is added to the JSON. Anything that’s that’s ommited form <code>attributes</code> is left out.</p>
<pre><code>class TodoSerializer &lt; ActiveModel::Serializer
  attributes :id, :title, :is_completed
end
</code></pre><p>Then if we refersh <code>http://localhost:3000/todos</code>, we’ll also notice that we have a <code>todos:</code> root for our json (which is what Ember expects), and we have ommited all unneeded properties from our objects (i.e. created_at and updated_at).</p>
<p><img src="../posts/2015-01-29-ember-to-rails-api/ep1-after-serializer.png" alt="After Serializer"></p>
<h2 id="switching-ember-app-to-activemodeladapter">Switching Ember App to ActiveModelAdapter</h2>
<p>So now let’s go back to TodoMVC and switch to using our API.</p>
<h3 id="boot-ember-with-proxy">Boot Ember with Proxy</h3>
<p>Let’s assume that our API will still be running on <code>http://localhost:3000/</code> and boot ember using a <code>--proxy</code> flag to route all relevant traffic through our api.</p>
<pre><code>ember serve --proxy http://localhost:3000
</code></pre><h3 id="switch-the-adapter">Switch the Adapter</h3>
<p>And finally, let’s switch our whole app to run off the API we just built! (Surprise! We only change one line of Ember code).</p>
<pre><code>import DS from &#39;ember-data&#39;;

export default DS.ActiveModelAdapter.extend({
});
</code></pre><p>Now go to the browser and check it out!</p>
<p><img src="../posts/2015-01-29-ember-to-rails-api/ep1-todomvc.png" alt="Todomvc with API"></p>
<p>Thanks for joining me on part one of Ember Problems. Next time we’ll be looking at pagination.</p>
<h3 id="edit-also-update-the-serializer">EDIT!: Also, Update the Serializer</h3>
<p>Make sure you are using <code>ActiveModelSerializer</code> so the names are correctly translating from Ember camelCase style to Rails rails_underscore_style. This will be in <code>app/serializers/application.js</code></p>
<pre><code>import DS from import DS from &#39;ember-data&#39;;

export default DS.ActiveModelSerializer.extend({});
</code></pre><p>Here is the final code: <a href="https://github.com/ryanlabouve/todomvc-embercli/tree/ep1">ryanlabouve/todomvc-embercli/tree/ep1</a>.</p>

        </div>
      </div>
    </div>
  </div>


  <div class="container">
  <div class="clearfix mxn1">
    <div class="sm-col sm-col-4 px1 mt2">
      <div class="box p3">
        <img class="profile-pic profile-pic-sm center-block" src="../about.jpg" alt="Ryan LaBouve, Profile Pic" />
        <h2 class="serif center">Ryan LaBouve</h2>
        <p class="center text-primary primary">—Ember.js &amp; Node—</p>
        <p class="h5 center">Disciple of Jesus Christ &amp; family man. Doer of JS &amp; maker of webs.</p>
      </div>
    </div>
     <div class="sm-col sm-col-4 px1 mt2">
      <div class="box">
        <div class="bar brand-article">
          <div class="btn serif italic"><span class="typcn typcn-document-text"></span> Recent Articles</div>
        </div>
      </div>
      <div class="box p2">
        
          <div class="bar">
            <a href="/ember-blog-with-jwt-and-esa-2" class="h6">

              Ember Blog with JWT and Ember Simpl... <div class="h6 muted right">04-18-16</div>
            </a>
            
              <div class="sep"></div>
            
          </div>
        
          <div class="bar">
            <a href="/ember-blog-with-jwt-and-esa" class="h6">

              Ember Blog with JWT and Ember Simpl... <div class="h6 muted right">04-17-16</div>
            </a>
            
              <div class="sep"></div>
            
          </div>
        
          <div class="bar">
            <a href="/jwt-rails-api-challenge" class="h6">

              JWT Rails API Challenge <div class="h6 muted right">04-12-16</div>
            </a>
            
              <div class="sep"></div>
            
          </div>
        
          <div class="bar">
            <a href="/ember-problems-infiniscroll-with-api" class="h6">

              Ember Problems Infiniscroll with an... <div class="h6 muted right">09-27-15</div>
            </a>
            
              <div class="sep"></div>
            
          </div>
        
          <div class="bar">
            <a href="/ember-problems-pagination-with-api" class="h6">

              Ember Problems, Pagination with an ... <div class="h6 muted right">09-26-15</div>
            </a>
            
          </div>
        
      </div>
    </div>
     <div class="sm-col sm-col-4 px1 mt2">
      <div class="box">
        <div class="brand-rss bar clearfix">
          <a href="http://twitter.com/ryanlabouve" class="btn btn-icon">
            <span class="typcn typcn-rss"></span> RSS
          </a>
        </div>
        <div class="brand-twitter bar clearfix">
          <a href="http://twitter.com/ryanlabouve" class="btn btn-icon">
            <span class="typcn typcn-social-twitter"></span> Twitter
          </a>
        </div>
        <div class="brand-linkedin bar clearfix">
          <a href="https://www.linkedin.com/in/ryanlabouve" class="btn btn-icon">
            <span class="typcn typcn-social-linkedin"></span> LinkedIn
          </a>
        </div>
        <div class="brand-github bar clearfix">
          <a href="http://github.com/ryanlabouve/" class="btn btn-icon">
            <span class="typcn typcn-social-github"></span> Github
          </a>
        </div>
        <div class="brand-dribbble bar clearfix">
          <a href="http://dribbble.com/ryanlabouve/" class="btn btn-icon">
            <span class="typcn typcn-social-dribbble"></span> Dribbble
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="mt4 center">
  <a href="http://holyarchers.com">
    <img src="/assets/ha-circle.png" height=25 width=25 style="vertical-align: text-bottom;" alt="HolyArchers.com" />
  </a>
</div>


  <script src="/js/app.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-71758047-2', 'auto');
    ga('send', 'pageview');

  </script>
</body>
</html>
